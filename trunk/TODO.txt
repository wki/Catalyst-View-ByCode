Changes C::V::ByCode

++ Tag.pm -- attr isa HashRef (!) -- no constraint here!


4) changed `yield()` magic:
   stash->{yield} = { yield_name => '/path/to/template' | ['/p/t/t', ...], ... }
   
   - yield() --> yields 'content'
   - if ref(yield_name) eq 'ARRAY' --> continue until array is empty
     --> yield-names act as hooks for generating stuff sometimes...


5) enhance form handling  +++ 'render' handling DONE
   - everything so far was nonsense. WE SIMPLY DO NOTHING.
   - magic handling via: div { stash->{form} };
     Trick: print OUT/RAW handles obj-refs specially
       $obj->can('render') --> do it
       $obj->can('to_string') ??? other names ???


6) example:

block draw_nav {
    my $navigation = attr('navigation');
    my $selected = attr('selected');
    my $id = attr('id');
    my $class = attr('class');
    return if (!$navigation);
    
    ul {
        id $id if ($id);
        class $class if ($class);
        
        foreach my $nav (@{$navigation}) {
            li {
                a(href => nav_uri($nav->parent
                                ? stash->{selected_navigation}->url_part 
                                : (), 
                                $nav->url_part)) {
                    class 'selected'
                        if ($selected && $nav->id == $selected->id);
                    $nav->name;
                };
            };
        }
    };
};

block infobox {
    my $id = attr('id');
    my $headline = attr('headline') || 'untitled';
    
    div.infobox {
        id $id if ($id);
        div.infobox_head { $headline };
        div.infobox_content {
            block_content;
        };
    };
};

template {
   doctype 'xhtml';
   html {
       head {
           title { stash->{title} || 'Seite Ohne Titel' };
           load Js  => 'site.js';
           load Css => 'site.css';
       };
       body {
           yield body_start;
           
           div header.class1.class2 {
               a(href => c->uri_for_action('/home')) {
                   img.logo(src => '/static/images/logo.png');
               };
               
               draw_nav topnav(navigation => ..., selected => ...);

               div.searchform { stash->{searchform}; };
           };
           
           div content {
               yield;
               
               infobox leftbox(headline => 'just an info') { ... some content ... };
           };
           
           div footer {
               # something
               
               yield footer;
           };
           
           yield body_end;
       };
   };
};




